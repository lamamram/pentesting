from scapy.all import *
from scapy.layers.inet import *

TARGET = "192.168.1.1"

# empilement des protocoles de la couche 
# 2 / liaison / Ethernet
# 3 / réseau / IP, ICMP
# 4 / transport / TCP, UDP ...
# 7 / application / HTTP, FTP, DNS,  ...
# "/" est l'opérateur d'empilement des couches
# chaque protocole est défini dans une classe
# avec des attribut représentant les champs de la trame
my_ping = IP(dst=TARGET) / ICMP()

# envoi sans attendre de réponse (1 ou n)
# send(my_ping)
# sendp(my_ping)

# envoi attente de réponses
resp = sr1(my_ping)
# resp, non_resp = srp(my_ping)

print(resp.show())