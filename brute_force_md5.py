# casser une fonction de hachage md5
# fonction de hachage: fonction injective qui transforme
# une entrée en chaine hexidécimale de 32 caractère
# garantie la quasi unicité du hash

from hashlib import md5
from string import ascii_lowercase
from itertools import count, product

message = "secret"

h = md5(bytes(message, "utf-8")).hexdigest()

# casser le md5 => tester toutes les possibilités de chaines
# de longueur 1, 2, 3, ...
# pour chaque longueur, les combinaisons de lettres avec répétition
# => produit cartésien

# print(list(combinations("abcd", 2)))

def brute_force(h):
    for i in count(1):
        print(i)
        for choice in product(ascii_lowercase, repeat=i):
            choice = "".join(choice)
            candidate = md5(bytes(choice, "utf-8")).hexdigest()
            if candidate == h:
                return f"le message est: {choice}"

if __name__ == "__main__":
    print(brute_force(h))